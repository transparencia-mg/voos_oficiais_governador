<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Voos Oficiais — Dashboard</title>

  <!-- Plotly -->
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
  <!-- PapaParse para CSV robusto -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
  <!-- SheetJS para Excel -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <!-- Font Awesome para ícones -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <!-- estilo -->
  <style>
    :root {
      --primary: #1a73e8;
      --primary-dark: #0d62d9;
      --secondary: #34a853;
      --danger: #ea4335;
      --warning: #fbbc04;
      --dark: #202124;
      --light: #f8f9fa;
      --gray: #5f6368;
      --gray-light: #dadce0;
      --border: #e8eaed;
      --card-shadow: 0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.24);
      --card-shadow-hover: 0 14px 28px rgba(0,0,0,0.12), 0 10px 10px rgba(0,0,0,0.08);
    }
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
      color: var(--dark);
      background-color: #f5f7fa;
      line-height: 1.6;
    }
    
    .container {
      max-width: 1400px;
      margin: 0 auto;
      padding: 0 20px;
    }
    
    /* Header e Navegação */
    .dashboard-header {
      background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
      color: white;
      padding: 0;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    
    .header-inner {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px 20px;
    }
    
    .brand {
      display: flex;
      align-items: center;
      gap: 15px;
    }
    
    .logo {
      width: 50px;
      height: 50px;
      background-color: white;
      color: var(--primary);
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      font-size: 24px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    }
    
    .brand h1 {
      font-size: 1.5rem;
      font-weight: 600;
      margin-bottom: 4px;
    }
    
    .subtitle {
      font-size: 0.9rem;
      opacity: 0.9;
    }
    
    /* Navegação */
    .nav-container {
      background-color: rgba(255,255,255,0.1);
      border-top: 1px solid rgba(255,255,255,0.2);
    }
    
    .nav-tabs {
      display: flex;
      list-style: none;
      padding: 0;
      margin: 0;
    }
    
    .nav-tab {
      padding: 16px 24px;
      cursor: pointer;
      font-weight: 500;
      border-bottom: 3px solid transparent;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .nav-tab:hover {
      background-color: rgba(255,255,255,0.1);
    }
    
    .nav-tab.active {
      background-color: rgba(255,255,255,0.15);
      border-bottom-color: white;
    }
    
    /* Main Content */
    .main-grid {
      display: grid;
      grid-template-columns: repeat(12, 1fr);
      gap: 20px;
      padding: 20px;
    }
    
    .card {
      background: white;
      border-radius: 12px;
      padding: 24px;
      box-shadow: var(--card-shadow);
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }
    
    .card:hover {
      box-shadow: var(--card-shadow-hover);
      transform: translateY(-2px);
    }
    
    /* Filtros */
    .filters {
      grid-column: 1 / span 12;
      margin-bottom: 0;
    }
    
    .filters-row {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      gap: 15px;
      align-items: end;
    }
    
    select, input {
      padding: 10px 12px;
      border: 1px solid var(--border);
      border-radius: 8px;
      background-color: white;
      font-size: 14px;
      color: var(--dark);
      width: 100%;
    }
    
    select:focus, input:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(26, 115, 232, 0.1);
    }
    
    /* Botões */
    .btn-primary {
      background-color: var(--primary);
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 500;
      transition: background-color 0.3s ease;
      display: flex;
      align-items: center;
      gap: 8px;
      justify-content: center;
    }
    
    .btn-primary:hover {
      background-color: var(--primary-dark);
    }
    
    .btn-ghost {
      background-color: transparent;
      color: var(--primary);
      border: 1px solid var(--primary);
      padding: 10px 20px;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 500;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 8px;
      justify-content: center;
    }
    
    .btn-ghost:hover {
      background-color: rgba(26, 115, 232, 0.05);
    }
    
    /* Summary Cards */
    .summary-row {
      grid-column: 1 / span 12;
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      padding: 20px;
    }
    
    .summary-card {
      text-align: center;
      padding: 20px;
      border-radius: 10px;
      background: linear-gradient(135deg, #f5f7fa 0%, #e4e8f0 100%);
    }
    
    .summary-card .big {
      font-size: 2.5rem;
      font-weight: 700;
      color: var(--primary);
      margin-bottom: 8px;
    }
    
    .summary-card .label {
      font-size: 0.9rem;
      color: var(--gray);
      font-weight: 500;
    }
    
    /* Tabela */
    .table-wrapper {
      overflow-x: auto;
      margin-top: 20px;
      border-radius: 8px;
      border: 1px solid var(--border);
    }
    
    table {
      width: 100%;
      border-collapse: collapse;
      min-width: 1000px;
    }
    
    th {
      background-color: #f8f9fa;
      padding: 14px 16px;
      text-align: left;
      font-weight: 600;
      color: var(--dark);
      border-bottom: 2px solid var(--border);
    }
    
    td {
      padding: 12px 16px;
      border-bottom: 1px solid var(--border);
    }
    
    tr:hover {
      background-color: #f8f9fa;
    }
    
    .table-actions {
      display: flex;
      gap: 10px;
      margin-top: 20px;
      justify-content: flex-end;
    }
    
    /* Footer */
    .footer {
      text-align: center;
      padding: 20px;
      color: var(--gray);
      font-size: 0.9rem;
      border-top: 1px solid var(--border);
      margin-top: 40px;
    }
    
    /* Badges */
    .badge {
      display: inline-block;
      padding: 4px 10px;
      border-radius: 20px;
      font-size: 0.8rem;
      font-weight: 500;
    }
    
    .badge-success {
      background-color: rgba(52, 168, 83, 0.1);
      color: var(--secondary);
    }
    
    .badge-danger {
      background-color: rgba(234, 67, 53, 0.1);
      color: var(--danger);
    }
    
    /* Download Section */
    .download-section {
      background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
      border-radius: 12px;
      padding: 24px;
      margin-top: 20px;
    }
    
    .download-options {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin-top: 20px;
    }
    
    .download-card {
      background: white;
      border-radius: 10px;
      padding: 20px;
      text-align: center;
      box-shadow: var(--card-shadow);
      transition: transform 0.3s ease;
    }
    
    .download-card:hover {
      transform: translateY(-5px);
    }
    
    .download-card i {
      font-size: 2.5rem;
      color: var(--primary);
      margin-bottom: 15px;
    }
    
    .download-card h4 {
      margin-bottom: 10px;
      color: var(--dark);
    }
    
    .download-card p {
      color: var(--gray);
      font-size: 0.9rem;
      margin-bottom: 20px;
    }
    
    /* Responsividade */
    @media (max-width: 1200px) {
      .main-grid {
        grid-template-columns: 1fr;
      }
      
      .card {
        grid-column: 1 / span 1 !important;
      }
    }
    
    @media (max-width: 768px) {
      .header-inner {
        flex-direction: column;
        align-items: flex-start;
        gap: 15px;
      }
      
      .nav-tabs {
        flex-wrap: wrap;
      }
      
      .nav-tab {
        padding: 12px 16px;
        font-size: 0.9rem;
      }
      
      .filters-row {
        grid-template-columns: 1fr;
      }
      
      .table-actions {
        flex-direction: column;
      }
      
      .btn-primary, .btn-ghost {
        width: 100%;
      }
    }
  </style>
</head>
<body>
  <header class="dashboard-header">
    <div class="container header-inner">
      <div class="brand">
        <div class="logo">MG</div>
        <div>
          <h1>Voos Oficiais — Governo de MG</h1>
          <div class="subtitle">Dashboard público de voos oficiais</div>
        </div>
      </div>
      <div class="header-actions">
        <button id="btn-portal-dados" class="btn-ghost">
          <i class="fas fa-external-link-alt"></i> Portal de Dados Abertos
        </button>
      </div>
    </div>
    
    <nav class="nav-container">
      <div class="container">
        <ul class="nav-tabs">
          <li class="nav-tab active" data-tab="overview">
            <i class="fas fa-chart-bar"></i> Visão Geral
          </li>
          <li class="nav-tab" data-tab="flights">
            <i class="fas fa-plane"></i> Voos
          </li>
          <li class="nav-tab" data-tab="download">
            <i class="fas fa-download"></i> Download de Dados
          </li>
          <li class="nav-tab" data-tab="about">
            <i class="fas fa-info-circle"></i> Sobre
          </li>
        </ul>
      </div>
    </nav>
  </header>

  <main class="container main-grid">
    <!-- Aba: Visão Geral (padrão) -->
    <div id="tab-overview" class="tab-content active">
      <!-- filtros -->
      <section class="card filters" id="filters">
        <h3><i class="fas fa-filter"></i> Filtros</h3>
        <div class="filters-row">
          <div>
            <label for="filter-ano">Ano</label>
            <select id="filter-ano"><option value="all">Todos os anos</option></select>
          </div>
          <div>
            <label for="filter-origem">Origem</label>
            <select id="filter-origem"><option value="all">Todas as origens</option></select>
          </div>
          <div>
            <label for="filter-destino">Destino</label>
            <select id="filter-destino"><option value="all">Todos os destinos</option></select>
          </div>
          <div>
            <label for="filter-orgao">Órgão</label>
            <select id="filter-orgao"><option value="all">Todos os órgãos</option></select>
          </div>
          <div>
            <label for="filter-situacao">Situação</label>
            <select id="filter-situacao">
              <option value="all">Todas as situações</option>
              <option value="REALIZADO">REALIZADO</option>
              <option value="CANCELADA">CANCELADA</option>
            </select>
          </div>
          <div class="filter-actions">
            <button id="btn-apply" class="btn-primary">
              <i class="fas fa-check"></i> Aplicar
            </button>
            <button id="btn-clear" class="btn-ghost">
              <i class="fas fa-broom"></i> Limpar
            </button>
          </div>
        </div>
      </section>

      <!-- cards resumo -->
      <section class="card summary-row" id="summary-row">
        <div class="summary-card">
          <div class="big" id="card-voos">—</div>
          <div class="label"><i class="fas fa-plane"></i> Voos (DB únicos)</div>
        </div>
        <div class="summary-card">
          <div class="big" id="card-horas">—</div>
          <div class="label"><i class="fas fa-clock"></i> Horas voadas</div>
        </div>
        <div class="summary-card">
          <div class="big" id="card-pass">—</div>
          <div class="label"><i class="fas fa-users"></i> Passageiros</div>
        </div>
        <div class="summary-card">
          <div class="big" id="card-destinos">—</div>
          <div class="label"><i class="fas fa-map-marker-alt"></i> Destinos</div>
        </div>
      </section>

      <!-- gráficos -->
      <section class="card" style="grid-column: 1 / span 6;">
        <h3><i class="fas fa-map-marked-alt"></i> Top Destinos</h3>
        <div id="chart-destinos" style="height:400px;"></div>
      </section>

      <section class="card" style="grid-column: 7 / span 6;">
        <h3><i class="fas fa-chart-line"></i> Horas Voadas por Mês</h3>
        <div id="chart-horas" style="height:400px;"></div>
      </section>

      <!-- tabela -->
      <section class="card" style="grid-column: 1 / span 12;">
        <h3><i class="fas fa-table"></i> Detalhamento de Registros (uma linha por passageiro)</h3>
        <div id="table-container" class="table-wrapper"></div>
        <div class="table-actions">
          <button id="btn-export-csv" class="btn-primary">
            <i class="fas fa-file-csv"></i> Exportar CSV
          </button>
          <button id="btn-export-xlsx" class="btn-ghost">
            <i class="fas fa-file-excel"></i> Exportar Excel (XLSX)
          </button>
        </div>
      </section>
    </div>

    <!-- Aba: Voos -->
    <div id="tab-flights" class="tab-content">
      <section class="card" style="grid-column: 1 / span 12;">
        <h2><i class="fas fa-plane"></i> Análise de Voos</h2>
        <p>Análise detalhada dos voos oficiais realizados pelo governo.</p>
        
        <div class="filters-row" style="margin-top: 20px;">
          <select id="flight-year"><option value="all">Todos os anos</option></select>
          <select id="flight-status">
            <option value="all">Todos os status</option>
            <option value="REALIZADO">Realizados</option>
            <option value="CANCELADA">Cancelados</option>
          </select>
          <button id="btn-analyze-flights" class="btn-primary">
            <i class="fas fa-chart-bar"></i> Analisar
          </button>
        </div>
        
        <div id="flight-analysis-content" style="margin-top: 30px;">
          <!-- Conteúdo será carregado via JS -->
        </div>
      </section>
    </div>

    <!-- Aba: Download de Dados -->
    <div id="tab-download" class="tab-content">
      <section class="card" style="grid-column: 1 / span 12;">
        <h2><i class="fas fa-download"></i> Download de Dados</h2>
        <p>Faça download dos dados completos ou filtrados dos voos oficiais.</p>
        
        <div class="download-section">
          <h3><i class="fas fa-filter"></i> Filtros para Download</h3>
          <div class="filters-row">
            <div>
              <label for="download-year">Ano</label>
              <select id="download-year">
                <option value="all">Todos os anos</option>
                <option value="2023">2023</option>
                <option value="2024">2024</option>
              </select>
            </div>
            <div>
              <label for="download-format">Formato</label>
              <select id="download-format">
                <option value="csv">CSV</option>
                <option value="xlsx">Excel (XLSX)</option>
                <option value="json">JSON</option>
              </select>
            </div>
            <div>
              <label for="download-type">Tipo de Dados</label>
              <select id="download-type">
                <option value="full">Dados Completos</option>
                <option value="summary">Resumo Consolidado</option>
                <option value="filtered">Dados Filtrados</option>
              </select>
            </div>
          </div>
          
          <div class="download-options">
            <div class="download-card">
              <i class="fas fa-file-csv"></i>
              <h4>CSV Completo</h4>
              <p>Download de todos os dados em formato CSV</p>
              <button class="btn-primary download-btn" data-format="csv">
                <i class="fas fa-download"></i> Baixar CSV
              </button>
            </div>
            
            <div class="download-card">
              <i class="fas fa-file-excel"></i>
              <h4>Excel (XLSX)</h4>
              <p>Dados formatados em planilha Excel</p>
              <button class="btn-primary download-btn" data-format="xlsx">
                <i class="fas fa-download"></i> Baixar Excel
              </button>
            </div>
            
            <div class="download-card">
              <i class="fas fa-database"></i>
              <h4>JSON</h4>
              <p>Dados em formato JSON para desenvolvedores</p>
              <button class="btn-ghost download-btn" data-format="json">
                <i class="fas fa-download"></i> Baixar JSON
              </button>
            </div>
          </div>
        </div>
      </section>
    </div>

    <!-- Aba: Sobre -->
    <div id="tab-about" class="tab-content">
      <section class="card" style="grid-column: 1 / span 12;">
        <h2><i class="fas fa-info-circle"></i> Sobre este Dashboard</h2>
        <p>Este dashboard apresenta dados públicos sobre voos oficiais realizados pelo governo de Minas Gerais.</p>
        
        <div style="margin-top: 30px;">
          <h3><i class="fas fa-database"></i> Fonte dos Dados</h3>
          <p>Os dados são atualizados regularmente a partir do Portal de Dados Abertos do Governo de Minas Gerais.</p>
          
          <h3 style="margin-top: 20px;"><i class="fas fa-chart-bar"></i> Métricas Disponíveis</h3>
          <ul style="margin-top: 10px; padding-left: 20px;">
            <li>Número total de voos (base deduplicada)</li>
            <li>Horas voadas totais</li>
            <li>Quantidade de passageiros transportados</li>
            <li>Destinos atendidos</li>
            <li>Análise por órgão governamental</li>
            <li>Status dos voos (realizados vs cancelados)</li>
          </ul>
          
          <h3 style="margin-top: 20px;"><i class="fas fa-external-link-alt"></i> Links Úteis</h3>
          <div style="margin-top: 15px; display: flex; gap: 10px; flex-wrap: wrap;">
            <a href="#" class="btn-ghost">
              <i class="fas fa-external-link-alt"></i> Portal de Dados Abertos
            </a>
            <a href="#" class="btn-ghost">
              <i class="fas fa-book"></i> Documentação
            </a>
            <a href="#" class="btn-ghost">
              <i class="fas fa-code"></i> API de Dados
            </a>
          </div>
        </div>
      </section>
    </div>
  </main>

  <footer class="footer">
    <div class="container">
      <p><i class="fas fa-database"></i> Dados abertos — atualizados via repositório GitHub.</p>
      <p style="margin-top: 10px; font-size: 0.8rem;">© 2024 Governo de Minas Gerais. Todos os direitos reservados.</p>
    </div>
  </footer>

  <script>
    // Sistema de abas
    document.querySelectorAll('.nav-tab').forEach(tab => {
      tab.addEventListener('click', function() {
        // Remove classe active de todas as abas
        document.querySelectorAll('.nav-tab').forEach(t => t.classList.remove('active'));
        document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
        
        // Adiciona classe active na aba clicada
        this.classList.add('active');
        const tabId = this.getAttribute('data-tab');
        document.getElementById(`tab-${tabId}`).classList.add('active');
      });
    });
    
    // Botão do portal de dados
    document.getElementById('btn-portal-dados').addEventListener('click', function() {
      window.open('https://dados.mg.gov.br', '_blank');
    });
    
    // Simulação de dados para os cards
    function updateSummaryCards() {
      document.getElementById('card-voos').textContent = '1.248';
      document.getElementById('card-horas').textContent = '2.847h';
      document.getElementById('card-pass').textContent = '3.892';
      document.getElementById('card-destinos').textContent = '156';
    }
    
    // Simulação de gráficos
    function renderCharts() {
      // Gráfico de destinos
      const destinosData = [{
        x: ['Belo Horizonte', 'São Paulo', 'Rio de Janeiro', 'Brasília', 'Uberlândia', 'Outros'],
        y: [320, 280, 195, 150, 120, 183],
        type: 'bar',
        marker: {
          color: '#1a73e8'
        }
      }];
      
      const destinosLayout = {
        title: '',
        margin: { t: 10, r: 30, b: 80, l: 60 },
        paper_bgcolor: 'transparent',
        plot_bgcolor: 'transparent'
      };
      
      Plotly.newPlot('chart-destinos', destinosData, destinosLayout);
      
      // Gráfico de horas por mês
      const horasData = [{
        x: ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun', 'Jul', 'Ago', 'Set', 'Out', 'Nov', 'Dez'],
        y: [210, 195, 230, 245, 260, 240, 255, 265, 250, 235, 220, 205],
        type: 'scatter',
        mode: 'lines+markers',
        line: {
          color: '#34a853',
          width: 3
        },
        marker: {
          color: '#34a853',
          size: 8
        }
      }];
      
      const horasLayout = {
        title: '',
        margin: { t: 10, r: 30, b: 50, l: 60 },
        paper_bgcolor: 'transparent',
        plot_bgcolor: 'transparent'
      };
      
      Plotly.newPlot('chart-horas', horasData, horasLayout);
    }
    
    // Simulação de tabela
    function renderTable() {
      const tableContainer = document.getElementById('table-container');
      tableContainer.innerHTML = `
        <table>
          <thead>
            <tr>
              <th>Data</th>
              <th>Origem</th>
              <th>Destino</th>
              <th>Órgão</th>
              <th>Passageiro</th>
              <th>Horas</th>
              <th>Status</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>15/03/2024</td>
              <td>Belo Horizonte (CNF)</td>
              <td>São Paulo (GRU)</td>
              <td>Secretaria de Saúde</td>
              <td>João Silva</td>
              <td>1.5h</td>
              <td><span class="badge badge-success">REALIZADO</span></td>
            </tr>
            <tr>
              <td>18/03/2024</td>
              <td>Belo Horizonte (CNF)</td>
              <td>Rio de Janeiro (GIG)</td>
              <td>Secretaria de Educação</td>
              <td>Maria Oliveira</td>
              <td>1.2h</td>
              <td><span class="badge badge-success">REALIZADO</span></td>
            </tr>
            <tr>
              <td>22/03/2024</td>
              <td>Uberlândia (UDI)</td>
              <td>Brasília (BSB)</td>
              <td>Secretaria de Infraestrutura</td>
              <td>Carlos Santos</td>
              <td>2.0h</td>
              <td><span class="badge badge-danger">CANCELADA</span></td>
            </tr>
          </tbody>
        </table>
      `;
    }
    
    // Botões de exportação
    document.getElementById('btn-export-csv').addEventListener('click', function() {
      alert('Exportação para CSV iniciada! Em uma implementação real, isso geraria um arquivo CSV.');
    });
    
    document.getElementById('btn-export-xlsx').addEventListener('click', function() {
      alert('Exportação para Excel iniciada! Em uma implementação real, isso geraria um arquivo XLSX.');
    });
    
    // Botões de download
    document.querySelectorAll('.download-btn').forEach(btn => {
      btn.addEventListener('click', function() {
        const format = this.getAttribute('data-format');
        const year = document.getElementById('download-year').value;
        alert(`Download do arquivo ${format.toUpperCase()} para o ano ${year} iniciado!`);
      });
    });
    
    // Inicialização
    document.addEventListener('DOMContentLoaded', function() {
      updateSummaryCards();
      renderCharts();
      renderTable();
      
      // Popula filtros de ano
      const yearSelect = document.getElementById('filter-ano');
      const currentYear = new Date().getFullYear();
      
      for (let year = currentYear; year >= 2020; year--) {
        const option = document.createElement('option');
        option.value = year;
        option.textContent = year;
        yearSelect.appendChild(option);
      }
    });
  </script>
</body>
</html>
